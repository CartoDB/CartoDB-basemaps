<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.css" />
  <!-- include cartodb.js library -->
  <script src="http://libs.cartocdn.com/cartodb.js/v3/cartodb.js"></script>
  <!--[if lte IE 8]>
    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.ie.css" />
  <![endif]-->
</head>
<body>
<a href="../">Interactive Map</a><br/>
Beyonce releases her new album online<br/>
Geotagged Tweets mentioning Beyonce's online self-titled album, December 12-13, 2013
<div id="map" style="height:800px"></div>
<script>

var vizjson = {
   "legends" : true,
   "zoom" : 2,
   "version" : "0.1.0",
   "overlays" : [
      {
         "template" : "<div class=\"loader\" original-title=\"\"></div>",
         "options" : {
            "y" : 150,
            "x" : 20,
            "display" : true
         },
         "order" : 8,
         "type" : "loader"
      },
      {
         "template" : "<a href=\"#zoom_in\" class=\"zoom_in\">+</a> <a href=\"#zoom_out\" class=\"zoom_out\">-</a>",
         "options" : {
            "y" : 20,
            "x" : 20,
            "display" : true
         },
         "order" : 6,
         "type" : "zoom"
      }
   ],
   "map_provider" : "leaflet",
   "bounds" : [
      [
         -60.5869673422587,
         -210.234375
      ],
      [
         78.9713859281822,
         252.421875
      ]
   ],
   "description" : "Geotagged Tweets mentioning Beyonce&#39;s online self-titled album, December 12-13, 2013",
   "center" : "[27.527758206861886, 21.09375]",
   "scrollwheel" : true,
   "updated_at" : null,
   "url" : null,
   "id" : "337d9194-6458-11e3-85b5-e5e70547d141",
   "title" : "Beyonce releases her new album online",
   "layers" : [
      {
         "tooltip" : null,
         "options" : {
            "base_type" : "midnight_cartodb",
            "visible" : true,
            "minZoom" : 0,
            "attribution" : "",
            "maxZoom" : 10,
            "name" : "CartoDB Midnight Commander",
            "className" : "httpscartocdn_sglobalsslfastlynetbasemidnightzxypng",
            "order" : 0,
            "urlTemplate" : "https://cartocdn_{s}.global.ssl.fastly.net/base-midnight/{z}/{x}/{y}.png",
            "read_only" : true,
            "id" : "65a12c96-4216-4049-999c-52d6fd8d951b",
            "type" : "Tiled"
         },
         "order" : 0,
         "type" : "tiled",
         "id" : "65a12c96-4216-4049-999c-52d6fd8d951b",
         "infowindow" : null
      },
      {
         "options" : {
            "sql_api_port" : 80,
            "stat_tag" : "337d9194-6458-11e3-85b5-e5e70547d141",
            "layer_name" : "beyonce",
            "torque-blend-mode" : "lighter",
            "tiler_protocol" : "http",
            "tiler_port" : "80",
            "tiler_domain" : "cartodb.com",
            "property" : "et",
            "cdn_url" : {
               "https" : "cartocdn.global.ssl.fastly.net",
               "http" : "api.cartocdn.com"
            },
            "torque-duration" : 30,
            "query" : "select * from beyonce",
            "sql_api_protocol" : "http",
            "sql_api_domain" : "cartodb.com",
            "user_name" : "srogers",
            "tile_style" : "/** torque visualization */\n\nMap {\n-torque-frame-count:512;\n-torque-animation-duration:30;\n-torque-time-attribute:\"et\";\n-torque-aggregation-function:\"count(cartodb_id)\";\n-torque-resolution:2;\n-torque-data-aggregation:\"linear\";\n}\n\n#beyonce{\n  marker-type: ellipse;\n  marker-width: 5;\n  marker-fill: #A53ED5;\n  marker-opacity: 0.9;\n  marker-line-width: 0;\n  marker-line-color: #FFF;\n  marker-line-opacity: 1;\n  comp-op: \"lighter\";\n}\n#beyonce[frame-offset=1] {\n marker-width:7;\n marker-opacity:0.45; \n}\n#beyonce[frame-offset=2] {\n marker-width:9;\n marker-opacity:0.225; \n}\n#beyonce[frame-offset=3] {\n marker-width:11;\n marker-opacity:0.15; \n}\n#beyonce[frame-offset=4] {\n marker-width:13;\n marker-opacity:0.1125; \n}\n#beyonce[frame-offset=5] {\n marker-width:15;\n marker-opacity:0.09; \n}\n#beyonce[frame-offset=6] {\n marker-width:17;\n marker-opacity:0.075; \n}\n#beyonce[frame-offset=7] {\n marker-width:19;\n marker-opacity:0.0642857142857143; \n}\n#beyonce[frame-offset=8] {\n marker-width:21;\n marker-opacity:0.05625; \n}\n#beyonce[frame-offset=9] {\n marker-width:23;\n marker-opacity:0.05; \n}",
            "sql_api_endpoint" : "/api/v2/sql",
            "table_name" : "beyonce"
         },
         "order" : 101,
         "legend" : {
            "show_title" : false,
            "template" : "",
            "title" : "",
            "type" : "none"
         },
         "type" : "torque",
         "id" : "7046ba41-0a2e-4789-adbd-816953df9758"
      }
   ]
}

function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

window.onload = function() {
  var lgid = getParameterByName("layergroupid");
  if (!lgid) {
    alert("Need to set url");
  }
  vizjson.layers[0].options.urlTemplate = lgid;
  cartodb.createVis('map', vizjson);
}
</script>
</body>
</html>
