<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.css" />
  <!-- include cartodb.js library -->
  <script src="http://libs.cartocdn.com/cartodb.js/v3/cartodb.js"></script>
  <!--[if lte IE 8]>
    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.ie.css" />
  <![endif]-->
</head>
<body>
<a href="../">Interactive Map</a><br/>
SF Restaurants
<div id="map" style="height:800px"></div>
<script>

var vizjson = {
    "bounds": [
        [
            37.72741604925924,
            -122.62664794921874
        ],
        [
            37.78808138412046,
            -122.18719482421874
        ]
    ],
    "center": "[37.757754935245835, -122.40692138671874]",
    "description": null,
    "id": "03e334ac-3d24-11e4-83d9-f23c91504230",
    "layers": [
        {
            "id": "e32a7812-bace-45c7-b59e-081a36577914",
            "infowindow": null,
            "options": {
                "attribution": "\u00a92012 Nokia <a href='http://here.net/services/terms' target='_blank'>Terms of use</a>",
                "base_type": "nokia_day",
                "className": "httpssmapsnlpnokiacommaptile21maptilenewestnormaldayzxy256png8lgengtokena7tbpacepg9mj_zghvkt9qapp_idkuyppsdxzznpffjskt24",
                "id": "385a6a97-51d6-4417-9fd9-0bc7dbd40dc3",
                "maxZoom": 21,
                "minZoom": 0,
                "name": "Nokia Day",
                "order": 0,
                "read_only": true,
                "subdomains": "1234",
                "type": "Tiled",
                "urlTemplate": "https://{s}.maps.nlp.nokia.com/maptile/2.1/maptile/newest/normal.day/{z}/{x}/{y}/256/png8?lg=eng&token=A7tBPacePg9Mj_zghvKt9Q&app_id=KuYppsdXZznpffJsKT24",
                "visible": true
            },
            "order": 0,
            "tooltip": null,
            "type": "tiled"
        },
        {
            "options": {
                "cdn_url": {
                    "http": "api.cartocdn.com",
                    "https": "cartocdn.global.ssl.fastly.net"
                },
                "named_map": {
                    "layers": [
                        {
                            "interactivity": null,
                            "layer_name": "businesses",
                            "legend": {
                                "items": [
                                    {
                                        "legend_type": "density",
                                        "name": "Less",
                                        "sync": true,
                                        "type": "text",
                                        "value": "less",
                                        "visible": true
                                    },
                                    {
                                        "legend_type": "density",
                                        "name": "More",
                                        "sync": true,
                                        "type": "text",
                                        "value": "more",
                                        "visible": true
                                    },
                                    {
                                        "name": "Color",
                                        "type": "color",
                                        "value": "#FFFFCC",
                                        "visible": true
                                    },
                                    {
                                        "name": "Color",
                                        "type": "color",
                                        "value": "#A1DAB4",
                                        "visible": true
                                    },
                                    {
                                        "name": "Color",
                                        "type": "color",
                                        "value": "#41B6C4",
                                        "visible": true
                                    },
                                    {
                                        "name": "Color",
                                        "type": "color",
                                        "value": "#2C7FB8",
                                        "visible": true
                                    },
                                    {
                                        "name": "Color",
                                        "type": "color",
                                        "value": "#253494",
                                        "visible": true
                                    }
                                ],
                                "show_title": false,
                                "template": "",
                                "title": "",
                                "type": "density"
                            }
                        }
                    ],
                    "name": "tpl_03e334ac_3d24_11e4_83d9_f23c91504230",
                    "params": {
                        "layer0": 1
                    },
                    "stat_tag": "03e334ac-3d24-11e4-83d9-f23c91504230"
                },
                "tiler_domain": "cartodb.com",
                "tiler_port": "80",
                "tiler_protocol": "http",
                "type": "namedmap",
                user_name: config.cdb_url.replace(/http(s?):\/\/(.*).cartodb.com/, "$2")
            },
            "order": 1,
            "type": "namedmap"
        }
    ],
    "map_provider": "leaflet",
    "overlays": [
        {
            "options": null,
            "order": null,
            "template": "<a class=\"zoom_in\">+</a><a class=\"zoom_out\">-</a>",
            "type": "zoom"
        },
        {
            "options": null,
            "order": null,
            "template": "<div class=\"loader\"></div>",
            "type": "loader"
        }
    ],
    "title": "RestaurantInspections",
    "updated_at": "2014-09-15T22:02:42+00:00",
    "url": null,
    "version": "0.1.0",
    "zoom": 13
}

function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

window.onload = function() {
  var lgid = getParameterByName("layergroupid");
  if (!lgid) {
    alert("Need to set url");
  }
  vizjson.layers[0].options.urlTemplate = lgid;
  cartodb.createVis('map', vizjson);
}
</script>
</body>
</html>


